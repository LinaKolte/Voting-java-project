<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Stephen Addo">
    <meta name="description" content="Download your voting card - An e-voting webapp">
    <title>Votum//Download Voting Card</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="icon" href="VOTUM.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css" integrity="sha384-b6lVK+yci+bfDmaY1u0zE8YYJt0TZxLEAFyYSLHId4xoVvsrQu3INevFKo+Xir8e" crossorigin="anonymous">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .voter-card-container {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-top: 120px;
            margin-bottom: 30px;
        }
        .card-header-banner {
            background: linear-gradient(135deg,#0ab459 0%, hsl(156, 77%, 45%) 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }
        .form-section {
            padding: 30px;
            border-bottom: 1px solid #e9ecef;
        }
        .preview-section {
            padding: 30px;
            background-color: #f8f9fa;
        }
        .voter-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 2px solid #198754;
            border-radius: 8px;
            padding: 20px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            max-width: 600px;
            margin: 0 auto;
        }
        .card-logo {
            display: flex;
            align-items: center;
            border-bottom: 2px solid #198754;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        .card-logo img {
            width: 60px;
            height: 60px;
            margin-right: 15px;
        }
        .card-logo-text h4 {
            font-size: 18px;
            font-weight: bold;
            margin: 0;
            color: #198754;
        }
        .card-logo-text p {
            font-size: 14px;
            margin: 0;
            color: #666;
        }
        .voter-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .detail-item {
            margin-bottom: 10px;
        }
        .detail-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 3px;
        }
        .detail-value {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            opacity: 0.1;
            font-size: 70px;
            pointer-events: none;
            font-weight: bold;
            color: #198754;
        }
        .photo-placeholder {
            width: 120px;
            height: 150px;
            background-color: #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #6c757d;
            border: 1px solid #ced4da;
            margin-bottom: 15px;
        }
        .status-message {
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        .success {
            background-color: #d1e7dd;
            color: #0f5132;
            border: 1px solid #badbcc;
        }
        .error {
            background-color: #f8d7da;
            color: #842029;
            border: 1px solid #f5c2c7;
        }
        .footer-links a {
            color: white;
            text-decoration: none;
        }
        .footer-links a:hover {
            text-decoration: underline;
        }
        .bicons a {
            display: block;
            margin-bottom: 8px;
            color: white;
            text-decoration: none;
        }
        .bicons a:hover {
            text-decoration: underline;
        }
        .foot {
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
        }
        .foot a {
            color: #198754;
            text-decoration: none;
        }
        .tabtext1, .tabtext2 {
            margin-bottom: 15px;
        }
        #card-download-instructions h1 {
            color: #198754;
            font-weight: bold;
        }
        @media (max-width: 768px) {
            .voter-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>

    <nav class="navbar navbar-expand-lg bg-success navbar-dark py-2 fixed-top">
        <div class="container justify-content-space-between">
            <img class="navbar-brand" id="logo" src="VOTUM.png" width="80px" height="80px" alt="Votum Logo">

            <button
            class="navbar-toggler"
            type="button" 
            data-bs-toggle="collapse" data-bs-target="#navmenu" aria-expanded="false"
            aria-label="toggle navigation"
            aria-controls="navmenu">
               <span class="navbar-toggler-icon"><span>
            </button>

            <div class="collapse navbar-collapse" id="navmenu">
                <ul id="menu" class="navbar-nav ms-auto text-light py-4">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">Home</a>
                    </li>
                    
                    <li class="nav-item">
                        <a href="card.html" class="nav-link active">Download Card</a>
                    </li>
                    <li class="nav-item">
                        <a href="lay.html" class="nav-link">Candidate Catalog</a>
                    </li>
                    <li class="nav-item">
                        <a href="result1.html" class="nav-link">Result</a>
                    </li>
                    <li class="nav-item">
                        <a href="contact.html" class="nav-link">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="voter-card-container">
            <div class="card-header-banner">
                <h2><i class="bi bi-credit-card-2-front"></i> Download Your Voting Card</h2>
                <p>Enter your Aadhar details to verify your identity and download your voting card</p>
            </div>
            
            <div class="row m-0">
                <div class="col-lg-5 form-section">
                    <h3 class="mb-4">Voter Verification</h3>
                    
                    <form id="cardDownloadForm">
                        <div class="mb-3">
                            <label for="aadharno" class="form-label">Aadhar Number</label>
                            <input
                                type="text"
                                class="form-control"
                                id="aadharno"
                                placeholder="Enter your 12-digit Aadhar number"
                                maxlength="12"
                                required
                            >
                        </div>
                        
                        <div class="mb-3">
                            <label for="dob" class="form-label">Date of Birth</label>
                            <input type="date" class="form-control" id="dob" required>
                        </div>
                        
                        <div class="mb-4">
                            <label for="email" class="form-label">Email Address</label>
                            <input type="email" class="form-control" id="email" placeholder="Enter your registered email address" required>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-success btn-lg" id="generateBtn">Verify & Generate Card</button>
                        </div>
                    </form>
                    
                    <div id="statusMessage" class="status-message"></div>
                    
                    <div id="card-download-instructions" class="mt-4 pt-3 border-top">
                        <h5 class="text-success"><i class="bi bi-info-circle"></i> Instructions</h5>
                        <ol class="mt-3">
                            <li>Enter your 12-digit Aadhar number</li>
                            <li>Provide your date of birth as registered</li>
                            <li>Enter the email address you used during registration</li>
                            <li>Click the "Verify & Generate Card" button</li>
                            <li>Click the "Download" button after card generation</li>
                        </ol>
                    </div>
                </div>
                
                <div class="col-lg-7 preview-section">
                    <div id="initialMessage" class="text-center py-5">
                        <i class="bi bi-credit-card-2-front" style="font-size: 4rem; color: #198754;"></i>
                        <h4 class="mt-3">Your Voter Card Will Appear Here</h4>
                        <p class="text-muted">Complete the verification process to generate your card</p>
                    </div>
                    
                    <div id="voterCardPreview" class="py-3" style="display: none;">
                        <h3 class="mb-4 text-center">Your Voter Card</h3>
                        
                        <div class="voter-card">
                            <div class="watermark">VOTUM</div>
                            
                            <div class="card-logo">
                                <img src="VOTUM.png" alt="Votum Logo">
                                <div class="card-logo-text">
                                    <h4>ELECTION COMMISSION</h4>
                                    <p>Official Voter Identification Card</p>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-4">
                                    <div class="photo-placeholder text-center">
                                        <span>Voter<br>Photo</span>
                                    </div>
                                </div>
                                <div class="col-8">
                                    <div class="voter-details">
                                        <div class="detail-item">
                                            <div class="detail-label">Voter ID</div>
                                            <div class="detail-value" id="voterId">VTRXXXXX</div>
                                        </div>
                                        <div class="detail-item">
                                            <div class="detail-label">Name</div>
                                            <div class="detail-value" id="voterName">John Doe</div>
                                        </div>
                                        <div class="detail-item">
                                            <div class="detail-label">Date of Birth</div>
                                            <div class="detail-value" id="voterDob">01/01/1990</div>
                                        </div>
                                        <div class="detail-item">
                                            <div class="detail-label">Gender</div>
                                            <div class="detail-value" id="voterGender">Male</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="voter-details mt-3">
                                <div class="detail-item">
                                    <div class="detail-label">Address</div>
                                    <div class="detail-value" id="voterAddress">123 Street Name, City, State, Postal Code</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Polling Station</div>
                                    <div class="detail-value" id="pollingStation">Central High School</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Constituency</div>
                                    <div class="detail-value" id="constituency">East District</div>
                                </div>
                                <div class="detail-item">
                                    <div class="detail-label">Card Issue Date</div>
                                    <div class="detail-value" id="issueDate">15/04/2025</div>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-center" id="barcode">
                                <img src="/api/placeholder/250/60" alt="Barcode">
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 mt-4">
                            <button type="button" class="btn btn-primary" id="downloadBtn">
                                <i class="bi bi-download"></i> Download Voter Card
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <section class="bg-primary text-white py-5 d-md-flex">
        <div class="container">
            <div class="row text-center">
                <div class="col-md">
                    <div>
                        <img class="img-fluid w-50 rounded-circle p-4" src="VOTUM.png" alt="Votum Logo">
                    </div>
                    <p>
                        A credible entity that sees to the affairs of a free and fair elections, promote integrity and voter's confidence in election.
                    </p>
                </div>
                <div class="col-md">
                    <div class="footerlist">
                        <h2 class="py-5">Overview</h2>
                        <div class="footer-links">
                            <div class="overfooterlist">
                                <a href="/">Home</a>
                            </div>
                            <div class="overfooterlist">
                                <a href="login.html">Login</a>
                            </div>
                            <div class="overfooterlist">
                                <a href="voting.html">Voting</a>
                            </div>
                            <div class="overfooterlist">
                                <a href="result1.html">Results</a>
                            </div>
                            <div class="overfooterlist">
                                <a href="about.html">About</a>
                            </div>
                        </div>
                    </div>
                    <div class="">
                        <div class="footerlist">
                             <h2 class="py-5">Support</h2>
                             <div class="footer-links">
                                <div class="overfooterlist">
                                    <a href="contact.html">Contact</a> 
                                </div>
                                <div class="overfooterlist">
                                    <a href="feedback.html">Feedback</a>
                                </div>
                                <div class="overfooterlist">
                                    <a href="faqs.html">FAQs</a>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>
                <div class="col-md py-5">
                    <h2>Connect With Us:</h2>
                    <div class="bicons">
                        <a href=""><i class="bi bi-envelope-at-fill"> G-mail</i></a>
                        <a href=""><i class="bi bi-facebook"> Facebook</i></a>
                        <a href=""><i class="bi bi-linkedin"> LinkedIn</i></a>
                        <a href=""><i class="bi bi-twitter"> Twitter</i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>
    <footer class="foot">
        &lt;&lt;&lt; &copy;Copyright | <a href="#">Addo Anim Stephen</a> &gt;&gt;&gt;
        <p>
           <a href="#">Back to Top</a>
        </p>
    </footer>
    <script>
document.addEventListener('DOMContentLoaded', function () {
    const generateBtn = document.getElementById('generateBtn');
    const aadharnoInput = document.getElementById('aadharno');
    const dobInput = document.getElementById('dob');
    const emailInput = document.getElementById('email');
    const statusMessage = document.getElementById('statusMessage');

    generateBtn.addEventListener('click', function (e) {
        e.preventDefault(); // Prevent form submission

        const aadharno = aadharnoInput.value.trim();
        const dob = dobInput.value.trim();
        const email = emailInput.value.trim();

        // Basic validation
        if (!aadharno || aadharno.length !== 12 || !/^\d{12}$/.test(aadharno)) {
            statusMessage.textContent = 'Please enter a valid 12-digit Aadhaar number.';
            statusMessage.className = 'text-danger';
            return;
        }

        if (!dob || !email) {
            statusMessage.textContent = 'Please fill in all the required fields (DOB and Email).';
            statusMessage.className = 'text-danger';
            return;
        }

        // Clear old messages
        statusMessage.textContent = '';
        statusMessage.className = '';

        // Disable button and show loading
        generateBtn.disabled = true;
        statusMessage.textContent = 'Generating your voter card...';
        statusMessage.className = 'text-info';

        // Make POST request to backend
        fetch('http://localhost:8080/api/voter/generate-id', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ aadharno: aadharno, dob: dob, email: email })
        })
        .then(response => {
            if (!response.ok) {
                if (response.status === 404) {
                    throw new Error('Voter not found. Please check your Aadhaar number.');
                } else if (response.status === 400) {
                    throw new Error('Details do not match. Please check your DOB and Email.');
                } else {
                    throw new Error('Failed to generate voter card. Please try again.');
                }
            }
            return response.blob();
        })
        .then(blob => {
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${aadharno}_voter_id.pdf`;
            document.body.appendChild(link);
            link.click();
            link.remove();
        })
        .catch(error => {
            console.error('Error:', error);
            statusMessage.textContent = error.message;
            statusMessage.className = 'text-danger';
        })
        .finally(() => {
            generateBtn.disabled = false;
            setTimeout(() => {
                statusMessage.classList.remove('text-info');
            }, 3000);
        });
    });
});
</script>
</body>
</html>